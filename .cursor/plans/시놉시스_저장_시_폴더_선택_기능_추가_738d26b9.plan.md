---
name: 시놉시스 저장 시 폴더 선택 기능 추가
overview: 시놉시스 입력 탭에 "새 프로젝트로 저장" 버튼을 추가하고, 기본 저장은 현재 프로젝트에 저장하도록 개선합니다. 새 프로젝트로 저장할 때는 폴더 선택 다이얼로그를 표시합니다.
todos:
  - id: add_project_number_utils
    content: 프로젝트 번호 자동 증가 함수 추가 (utils/file_utils.py)
    status: completed
  - id: add_project_folder_creation
    content: 프로젝트 폴더 생성 메서드 추가 (FileService)
    status: completed
    dependencies:
      - add_project_number_utils
  - id: add_script_file_methods
    content: 대본 파일 저장/로드 메서드 추가 (FileService)
    status: completed
  - id: modify_synopsis_save
    content: 시놉시스 저장 시 프로젝트 폴더 자동 생성 (synopsis_input_tab.py)
    status: completed
    dependencies:
      - add_project_folder_creation
  - id: modify_script_save
    content: 대본 저장 시 별도 파일로 저장 (scripts_tab.py)
    status: completed
    dependencies:
      - add_script_file_methods
  - id: modify_scenes_save
    content: 장면 생성 시 대본 파일에 scenes 추가 (scenes_tab.py)
    status: completed
    dependencies:
      - add_script_file_methods
---

# 시놉시스 저장 시 폴더 선택 기능 추가

## 목표

시놉시스를 저장할 때 사용자가 선택할 수 있도록:

1. 기본 저장: 현재 프로젝트에 저장 (기존 프로젝트가 있으면 덮어쓰기, 없으면 새로 생성)
2. 새 프로젝트로 저장: 항상 폴더 선택 다이얼로그를 표시하여 새 프로젝트 폴더 선택

## 구현 계획

### 1. 시놉시스 입력 탭 UI 개선

**파일**: `gui/tabs/synopsis_input_tab.py`

- 버튼 영역에 "새 프로젝트로 저장" 버튼 추가
- 기존 "파싱 및 저장" 버튼은 현재 프로젝트에 저장 (기존 동작 유지)
- "새 프로젝트로 저장" 버튼 클릭 시:
- 폴더 선택 다이얼로그 표시
- 선택한 폴더에 새 프로젝트 생성 또는 기존 폴더 사용
- 프로젝트 경로 업데이트 및 데이터 저장

### 2. 저장 로직 분리

**파일**: `gui/tabs/synopsis_input_tab.py`

- `_parse_and_save()`: 현재 프로젝트에 저장 (기존 로직)
- `_parse_and_save_as_new_project()`: 새 프로젝트로 저장
- 폴더 선택 다이얼로그 표시
- 선택한 폴더에 프로젝트 생성 (없으면 생성, 있으면 사용)
- 프로젝트 경로 업데이트
- 데이터 저장 및 모든 탭 업데이트

### 3. 프로젝트 폴더 생성 로직 개선

**파일**: `services/file_service.py`

- `create_project_folder()` 메서드는 이미 존재하므로 그대로 사용
- 선택한 폴더가 이미 프로젝트 폴더인 경우 처리 (덮어쓰기 또는 경고)

## 동작 방식

### 기본 저장 (파싱 및 저장 버튼)

1. 시놉시스 파싱
2. 현재 프로젝트 경로 확인
3. 유효한 프로젝트 폴더이면 → 현재 폴더에 저장 (덮어쓰기)
4. 유효한 프로젝트 폴더가 아니면 → 새 프로젝트 폴더 자동 생성 후 저장

### 새 프로젝트로 저장 (새 프로젝트로 저장 버튼)

1. 시놉시스 파싱
2. 폴더 선택 다이얼로그 표시
3. 사용자가 폴더 선택:

- 새 폴더 선택 → 새 프로젝트 폴더 생성
- 기존 프로젝트 폴더 선택 → 해당 폴더에 저장 (덮어쓰기 확인)

4. 프로젝트 경로 업데이트
5. 데이터 저장 및 모든 탭 업데이트
6. 설정 파일에 마지막 프로젝트 경로 저장

## 수정할 파일 목록

1. `gui/tabs/synopsis_input_tab.py` - UI 개선 및 저장 로직 분리

## 주의사항

- 기존 프로젝트 폴더를 선택했을 때 덮어쓰기 확인 메시지 표시
- 새 프로젝트로 저장 후 현재 프로젝트 경로가 변경되므로 모든 탭 업데이트 필요
- 설정 파일에 마지막 프로젝트 경로 저장